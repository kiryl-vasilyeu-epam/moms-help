<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XLS Item Parser</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã–ø–∏—Å–æ–∫ 1C –∏ Fusion</h1>
        
        <div class="upload-section">
            <div class="upload-box">
                <h3>–§–∞–π–ª 1: 1C –≤—ã–ø–∏—Å–∫–∞</h3>
                <label for="file1" class="file-label">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</label>
                <input type="file" id="file1" accept=".xls,.xlsx">
                <div class="file-name" id="file1-name">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
            </div>
            
            <div class="upload-box">
                <h3>–§–∞–π–ª 2: Fusion –≤—ã–ø–∏—Å–∫–∞</h3>
                <label for="file2" class="file-label">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</label>
                <input type="file" id="file2" accept=".xls,.xlsx">
                <div class="file-name" id="file2-name">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
            </div>
        </div>
        
        <div class="button-row">
            <button class="process-btn" id="processBtn" disabled>–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª—ã</button>
            <button class="clear-btn-small" onclick="clearLocalStorage()" title="–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ">‚úï</button>
        </div>
        
        <button class="download-btn" id="downloadBtn" onclick="downloadXLS()" style="display: none;">üì• –°–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ (.xlsx)</button>
        
        <button class="transfer-btn" id="transferBtn" onclick="transferToPriceMatcher()" style="display: none;">üí∞ –ü–µ—Ä–µ–¥–∞—Ç—å –≤ –ü–æ–∏—Å–∫ —Ü–µ–Ω</button>
        
        <div class="results" id="results" style="display: none;">
            <div class="stats">
                <div class="stat-box">
                    <h4>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ (1C)</h4>
                    <p id="totalItems">0</p>
                </div>
                <div class="stat-box">
                    <h4>–¢–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</h4>
                    <p id="matchedItems">0</p>
                </div>
                <div class="stat-box">
                    <h4>–ù–µ—á–µ—Ç–∫–∏–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</h4>
                    <p id="fuzzyItems">0</p>
                </div>
                <div class="stat-box">
                    <h4>–†—É—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</h4>
                    <p id="manualItems">0</p>
                </div>
                <div class="stat-box">
                    <h4>–ù–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
                    <p id="unmatchedItems">0</p>
                </div>
            </div>
            
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all" onclick="setFilter('all')">–í—Å–µ</button>
                <button class="filter-btn" data-filter="exact" onclick="setFilter('exact')">–¢–æ—á–Ω—ã–µ</button>
                <button class="filter-btn" data-filter="fuzzy" onclick="setFilter('fuzzy')">–ù–µ—á–µ—Ç–∫–∏–µ</button>
                <button class="filter-btn" data-filter="manual" onclick="setFilter('manual')">–†—É—á–Ω—ã–µ</button>
                <button class="filter-btn" data-filter="unmatched" onclick="setFilter('unmatched')">–ù–µ –Ω–∞–π–¥–µ–Ω—ã</button>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>–ê—Ä—Ç–∏–∫—É–ª (1C)</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        <th>–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞</th>
                        <th>–ê—Ä—Ç–∏–∫—É–ª (Fusion)</th>
                        <th>–°—Ç–∞—Ç—É—Å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
